"use strict";!function(n){var e={init:function(n,t){return e.__eventOnChange=n,e.__eventOnNotFound=t,"onhashchange"in window?(e.__bindHashChange(),""==window.location.hash||"#"==window.location.hash?(e.__listener("#/"),!0):(e.__listener(window.location.hash),!0)):(console.error("The browser doesn't support HASH on URL!"),!1)},navigate:function(n){window.location.hash=n},run:function(n){null!=e.__eventOnChange&&e.__eventOnChange(n),e.__run(n,"before")},add:function(n,t){var a=!1;if(!n.path)return console.error("Cannot find property path when adding a new route!"),!1;for(var r=0;r<e.routes.length;r++)if(e.routes[r].path===n.path){if(a=!0,!0===t)return e.routes[r]=n,!0;break}return a?(console.error("A route for the path "+n.path+" is already mapped!"),!1):(e.routes.push(n),!0)},findRoute:function(n){for(var t=0;t<e.routes.length;t++)if(e.routes[t].path===n)return e.routes[t]},matchRoute:function(n){var t=e.__cleanHash(n),a=t.hashParams.split("/"),r=t.hashParams,o={},h={};if(t.hashQueryArray.length>0)for(var s=0;s<t.hashQueryArray.length;s++){var u=t.hashQueryArray[s].split("=");u.length>=1&&u[0]&&(h[decodeURIComponent(u[0])]=u[1]?decodeURIComponent(u[1]):"")}for(var i=0;i<e.routes.length;i++){var _=e.routes[i];if(r=t.hashParams,_.path.search(/:/)>0)for(var l=_.path.split("/"),c=0;c<l.length;c++)c<a.length&&":"===l[c].charAt(0)&&(o[l[c].replace(/:/,"")]=a[c],r=r.replace(a[c],l[c]));if(_.path===r)return _.params=o,_.url=n,_.query=h,_}return null},actualRoute:function(){return this.matchRoute(window.location.hash)},routes:[],__bindHashChange:function(){window.onhashchange=function(){e.__listener(location.hash)}},__cleanHash:function(n){var t={},a=n.indexOf("?");t.hash=n,t.hashParams=a>=0?n.substring(0,a):n,t.hashQuery=a>=0?n.substring(n.indexOf("?")+1):"",t.hashQueryArray=t.hashQuery?t.hashQuery.split("&"):[];var r=t.hashParams.replace(/\/+$/,"");return t.hashParams!==r&&(window.onhashchange=null,t.hash=r,t.hash+=t.hashQuery?"?"+t.hashQuery:"",window.location.hash=t.hash,e.__bindHashChange()),t},__listener:function(n){var t=e.matchRoute(n);return t||e.__eventOnNotFound?!t&&e.__eventOnNotFound?(e.__eventOnNotFound(e.__hashToArray(n)),!1):e.run(t):(console.error("Cannot find a valid route for hash "+n+"!"),!1)},__hashToArray:function(n){var e=n.split("/");return e.length>0&&"#"==e[0]&&e.shift(),e},__run:function(n,t,a){if(n[t]){var r=new e.__task(function(a){var r=e.__nextState(t);r&&e.__run(n,r,a)});n.event={},n.event.previousResult=a,n.event.state=t,n.task=r,n[t]()}else{var o=e.__nextState(t);o&&e.__run(n,o)}},__nextState:function(n){return"before"==n?"on":"on"==n?"after":null},__eventOnChange:null,__eventOnNotFound:null,__task:function(n){return{__callback:n,done:function(n){this.__callback(n)}}}};n.Router=e}(this);